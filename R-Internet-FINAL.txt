!========================================
! R-INTERNET - CONFIGURATION COMPLETE
! Copy-Paste Ready for GNS3
!========================================

enable
configure terminal
hostname R-Internet

!========================================
! INTERFACE WAN (Internet Simule)
!========================================
interface FastEthernet0/0
 description WAN Internet - NAT Outside
 ip address 203.0.113.1 255.255.255.0
 ip nat outside
 no shutdown
 exit

!========================================
! INTERFACES SERIAL VERS BACKBONE (NAT INSIDE)
!========================================

interface Serial1/0
 description Liaison vers R1-Backbone
 ip address 41.16.1.25 255.255.255.252
 ip nat inside
 encapsulation ppp
 no shutdown
 exit

interface Serial1/1
 description Liaison vers R2-Backbone
 ip address 41.16.1.29 255.255.255.252
 ip nat inside
 encapsulation ppp
 no shutdown
 exit

interface Serial1/2
 description Liaison vers R3-Backbone
 ip address 41.16.1.33 255.255.255.252
 ip nat inside
 encapsulation ppp
 no shutdown
 exit

interface Serial1/3
 description Liaison vers R4-Backbone
 ip address 41.16.1.37 255.255.255.252
 ip nat inside
 encapsulation ppp
 no shutdown
 exit

!========================================
! CONFIGURATION OSPF
!========================================
router ospf 1
 router-id 5.5.5.5
 log-adjacency-changes
 passive-interface FastEthernet0/0
 network 41.16.1.24 0.0.0.3 area 0
 network 41.16.1.28 0.0.0.3 area 0
 network 41.16.1.32 0.0.0.3 area 0
 network 41.16.1.36 0.0.0.3 area 0
 default-information originate always
 exit

!========================================
! CONFIGURATION NAT
!========================================

! NAT Statique - Serveur Web (RZ-1)
ip nat inside source static tcp 192.168.0.20 80 203.0.113.20 80
ip nat inside source static tcp 192.168.0.20 443 203.0.113.20 443

! NAT Statique - Serveur IT/Monitoring (RZ-2)
ip nat inside source static 192.168.40.20 203.0.113.40

! NAT Statique - Serveur Database (RZ-3)
ip nat inside source static tcp 192.168.32.20 3306 203.0.113.32 3306

! NAT Statique - Serveur Collaboration (RZ-4)
ip nat inside source static 192.168.46.20 203.0.113.46

! NAT Dynamique (PAT) pour tout le trafic interne
access-list 1 permit 192.168.0.0 0.0.127.255
access-list 1 permit 41.16.0.0 0.0.255.255
ip nat inside source list 1 interface FastEthernet0/0 overload

!========================================
! ROUTES STATIQUES
!========================================

! Route par defaut vers Internet
ip route 0.0.0.0 0.0.0.0 203.0.113.254

! Routes vers les reseaux departementaux (via OSPF normalement)
! Ces routes sont optionnelles si OSPF fonctionne correctement
ip route 192.168.0.0 255.255.224.0 41.16.1.26
ip route 192.168.32.0 255.255.248.0 41.16.1.34
ip route 192.168.40.0 255.255.252.0 41.16.1.30
ip route 192.168.46.0 255.255.255.128 41.16.1.38

!========================================
! SAUVEGARDE
!========================================
end
write memory

!========================================
! VERIFICATION
!========================================
! Commandes de verification a executer:
! show ip interface brief
! show ip nat translations
! show ip ospf neighbor
! show ip route
! show running-config | include nat
